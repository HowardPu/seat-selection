(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{37:function(e,t,a){e.exports=a(60)},46:function(e,t,a){},47:function(e,t,a){},60:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),i=a(6),o=a.n(i),s=(a(46),a(8)),l=a(9),c=a(11),u=a(10),m=a(13),h=a(12),d=(a(47),a(62)),f=a(64),p=a(63),v=a(61),g=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={start:!1},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return this.state.start?r.a.createElement(v.a,{to:"/disclaimer"}):r.a.createElement("div",{className:"main-page-container"},r.a.createElement("div",{className:"full-bloom main-title-item"},r.a.createElement("h1",null,"\u957f\u6625\u5e02\u56fe\u4e66\u9986\u667a\u80fd\u9009\u5ea7\u7cfb\u7edf")),r.a.createElement("div",{className:"main-container"},r.a.createElement("div",{className:"main-item full-bloom"},r.a.createElement("h2",{className:"main-item-title"},"\u5feb\u901f\u62a2\u5ea7"),r.a.createElement("p",null,"\u76f8\u5bf9\u4e8e\u4f20\u7edf\u7684\u5fae\u4fe1\u9009\u5ea7\uff0c\u672c\u667a\u80fd\u9009\u5ea7\u65e0\u53cd\u5e94\u65f6\u95f4\uff0c\u53ef\u4ee5\u540c\u65f6\u62a2\u5ea7\uff0c\u5e76\u6839\u636e\u957f\u6625\u5e02\u56fe\u4e66\u9986\u670d\u52a1\u5668\u7684\u66f4\u65b0\u901f\u5ea6\u62a2\u5ea7\uff0c\u6781\u5927\u51cf\u5c0f\u5931\u624b\u98ce\u9669\u3002")),r.a.createElement("div",{className:"main-item full-bloom"},r.a.createElement("h2",{className:"main-item-title"},"\u667a\u80fd\u62a2\u5ea7"),r.a.createElement("p",null,"\u672c\u7cfb\u7edf\u53ef\u6839\u636e\u7528\u6237\u7684\u503e\u5411\u4ee5\u53ca\u5f53\u524d\u53ef\u4ee5\u9009\u62e9\u7684\u5ea7\u4f4d\u8fdb\u884c\u53c2\u8003\uff0c\u786e\u4fdd\u6bcf\u4f4d\u4f7f\u7528\u7684\u7528\u6237\u9009\u5230\u76ee\u6807\u5ea7\u4f4d")),r.a.createElement("div",{className:"main-item full-bloom"},r.a.createElement("h2",{className:"main-item-title"},"\u81ea\u52a9\u62a2\u5ea7"),r.a.createElement("p",null,"\u4fe1\u4e0d\u8fc7\u4f60\u7684\u8bbe\u5907\uff1f\u81ea\u4e3b\u9009\u5ea7\u7cfb\u7edf\u53ef\u8ba9\u60a8\u63d0\u524d\u8fdb\u5165\u62a2\u5ea7\u7cfb\u7edf\uff0c\u5148\u4eba\u4e00\u6b65\u83b7\u5f97\u5ea7\u4f4d\u3002"))),r.a.createElement("button",{className:"button-item btn btn-primary main-button",onClick:function(){e.setState({start:!0})}},"\u5f00\u59cb\u9009\u5ea7"))}}]),t}(n.Component),b=a(20),E=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={agree:!1,redirect:!1,cancel:!1},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;if(this.state.cancel)return r.a.createElement(v.a,{to:"/"});if(this.state.redirect)return r.a.createElement(v.a,{to:"/id-collecter"});var t="danger",a="\u60a8\u9700\u52fe\u9009\u201c\u6211\u5df2\u9605\u8bfb\u514d\u8d23\u58f0\u660e\u201d";return this.state.agree&&(t="success",a="\u8fdb\u5165\u667a\u80fd\u9009\u5ea7\u7cfb\u7edf"),r.a.createElement("div",{className:"disclaimer-page-container full-bloom"},r.a.createElement("div",null,r.a.createElement("h1",null,"\u514d\u8d23\u58f0\u660e"),r.a.createElement("ul",{className:"disclaimer-list"},r.a.createElement("li",null,"\u60a8\u9700\u8981\u9996\u5148\u6fc0\u6d3b\u957f\u6625\u5e02\u56fe\u4e66\u9986\u5fae\u4fe1\u62a2\u5ea7\u3002"),r.a.createElement("li",null,"\u60a8\u9700\u8981\u5f00\u542f\u60a8\u6d4f\u89c8\u5668\u7684",r.a.createElement("a",{href:"https://en.wikipedia.org/wiki/Cross-origin_resource_sharing",target:"_blank",rel:"noopener noreferrer"},"\u8de8\u4f86\u6e90\u8cc7\u6e90\u5171\u4eab"),"\u529f\u80fd\u3002"),r.a.createElement("li",null,"\u6b64\u7cfb\u7edf\u5e76\u4e0d\u80fd100%\u786e\u4fdd\u60a8\u60f3\u8981\u7684\u5ea7\u4f4d\u3002"),r.a.createElement("li",null,"\u6b64\u7cfb\u7edf\u53ef\u80fd\u4f1a\u6839\u636e\u62a2\u5ea7\u673a\u5236\u7684\u6539\u53d8\u800c\u5931\u6548\u3002"),r.a.createElement("li",null,"\u6839\u636e\u957f\u6625\u5e02\u56fe\u4e66\u9986\u89c4\u7ae0\u5236\u5ea6\uff0c\u4f7f\u7528\u672c\u7cfb\u7edf\u65f6\u53ef\u80fd\u4f1a\u627f\u62c5\u8bfb\u4e66\u5361\u88ab\u7981\u7528\u7684\u98ce\u9669\u3002"),r.a.createElement("li",null,"\u60a8\u9700\u627f\u62c5\u514d\u8d23\u58f0\u660e\u4e2d\u7684\u6240\u6709\u60c5\u51b5\u4ee5\u53ca\u5c1a\u672a\u63d0\u53ca\u7684\u6240\u6709\u7ed3\u679c.")),r.a.createElement(b.a,{check:!0},r.a.createElement(b.c,{check:!0},r.a.createElement(b.b,{type:"checkbox",onClick:function(){e.setState({agree:!e.state.agree})}}),"\u6211\u5df2\u9605\u8bfb\u514d\u8d23\u58f0\u660e\u3002"))),r.a.createElement("div",{className:"disclaimer-button-panel cancel-button"},r.a.createElement("button",{className:"button-item btn btn-primary",onClick:function(){e.setState({cancel:!0})}},"\u53d6\u6d88"),r.a.createElement("button",{disabled:!this.state.agree,className:"button-item btn btn-"+t+" confirm-button",onClick:function(){e.props.setValueHandler("condition",!0),e.setState({redirect:!0})}},a)))}}]),t}(n.Component),y=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).testURL="http://wx.jlcclib.com/wechat/obtainYlist?openId=of_",a.state={valid:null,readerID:"",redirect:!1},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"testVadility",value:function(){var e=this,t=this.testURL+this.state.readerID;fetch(t).then(function(e){return e.text()}).then(function(t){var a=t.split(/[\s,;\t\n]+/);e.setState({valid:a.includes("openId")})})}},{key:"handleChange",value:function(e){var t=e.target.value,a=e.target.name,n=this.state;n[a]=t,this.setState(n)}},{key:"render",value:function(){var e=this;return this.props.agree?this.state.redirect?r.a.createElement(v.a,{to:"/seat-selection"}):r.a.createElement("div",{className:"collection-page-container"},r.a.createElement("div",{className:"full-bloom"},r.a.createElement("div",{className:"collection-page-title-panel"},r.a.createElement("h1",null,"\u8bfb\u8005\u5e8f\u5217\u53f7\u68c0\u6d4b"),r.a.createElement("button",{className:"button-item btn btn-danger",onClick:function(){e.props.setValueHandler("condition",!1)}},"\u53d6\u6d88")),r.a.createElement("div",null,!1===this.state.valid&&r.a.createElement("div",{className:"alert alert-danger"},"\u6b64\u8bfb\u8005\u5e8f\u5217\u53f7\u4e3a\u65e0\u6548\u5e8f\u5217\u53f7"),!0===this.state.valid&&r.a.createElement("div",{className:"alert alert-success"},"\u6b64\u8bfb\u8005\u5e8f\u5217\u53f7\u4e3a\u6709\u6548\u5e8f\u5217\u53f7"),r.a.createElement("div",null,r.a.createElement("input",{className:"form-control",name:"readerID",value:this.state.readerID,onChange:function(t){e.handleChange(t),e.setState({valid:null})},placeholder:"\u4f8b\u5982\uff1aG7jlCSEOE6r1oXLK2gp1_HlRg"}))),r.a.createElement("div",{className:"collection-page-button-panel"},r.a.createElement("button",{className:"button-item btn btn-primary",onClick:function(){e.testVadility(e.state.readerID)}},"\u68c0\u6d4b\u8bfb\u8005\u5e8f\u5217\u53f7"),r.a.createElement("button",{className:"button-item btn btn-success",disabled:!this.state.valid,onClick:function(){e.props.setValueHandler("userID",e.state.readerID),e.setState({redirect:!0})}},"\u8fdb\u5165\u62a2\u5ea7\u7cfb\u7edf"))),r.a.createElement("div",{className:"full-bloom open-id-wiki"},r.a.createElement("h2",null,"\u4f55\u4e3a\u8bfb\u8005\u5e8f\u5217\u53f7\uff1f"),r.a.createElement("p",null,"\u6b64\u5e8f\u5217\u53f7\u662f\u6839\u636e\u60a8\u7684\u8bfb\u4e66\u8bc1\u53f7\u6240\u81ea\u52a8\u4ea7\u751f\u7684\u4e00\u7ec4\u5b57\u7b26\u4e32\uff0c\u60a8\u53ef\u7528\u8be5\u5e8f\u5217\u53f7\u6765\u9884\u7ea6/\u79bb\u5f00\u5ea7\u4f4d\u3002")),r.a.createElement("div",{className:"full-bloom open-id-help"},r.a.createElement("h2",null,"\u5982\u4f55\u83b7\u53d6\u8bfb\u8005\u5e8f\u5217\u53f7\uff1f"),r.a.createElement("ul",null,r.a.createElement("li",null,"\u9996\u5148\u5728\u624b\u673a\u4e2d\u8fdb\u5165\u60a8\u7684\u81ea\u4fee\u5ba4\u5fae\u4fe1\u9884\u7ea6\u7a0b\u5e8f\u4e3b\u83dc\u5355\u3002"),r.a.createElement("li",null,"\u7136\u540e\u7528\u4efb\u610f\u6d4f\u89c8\u5668\u6253\u5f00\u8be5\u7f51\u7ad9\u3002"),r.a.createElement("li",null,'\u89c2\u5bdf\u8fd9\u4e2a\u7f51\u5740\uff0c\u60a8\u4f1a\u53d1\u73b0\u5728"code=_of"\u540e\u6709\u4e00\u7ec4\u5b57\u7b26\u4e32\u3002'),r.a.createElement("li",null,"\u5c06\u8fd9\u4e2a\u5b57\u7b26\u4e32\u590d\u5236\uff0c\u8fd9\u5c31\u662f\u60a8\u7684\u8bfb\u8005\u5e8f\u5217\u53f7\u3002"),r.a.createElement("li",null,"(\u5728\u60a8\u66f4\u6362\u8bfb\u4e66\u8bc1\u6216\u66f4\u6539\u5fae\u4fe1\u7ed1\u5b9a\u5e10\u53f7\u65f6\uff0c\u9700\u91cd\u65b0\u68c0\u67e5\u60a8\u7684\u8bfb\u8005\u5e8f\u5217\u53f7\u3002)")))):r.a.createElement(v.a,{to:"/"})}}]),t}(n.Component),S=a(21),P=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={redirectToAutoSelection:!1,selfSeatSelectionStatus:null},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;if(!this.props.userID||!this.props.agree)return r.a.createElement(v.a,{to:"/"});if(this.state.redirectToAutoSelection)return r.a.createElement(v.a,{to:"/auto-selection"});var t="\u5c1a\u672a\u8fdb\u5165\u5ea7\u4f4d\u9884\u7ea6\u7f51\u7ad9",a="bg-secondary text-white";return!0===this.state.selfSeatSelectionStatus?(t="\u6210\u529f\u8fdb\u5165\u9009\u5ea7\u7f51\u7ad9",a="bg-success text-white"):!1===this.state.selfSeatSelectionStatus&&(t="\u8bfb\u53d6\u5931\u8d25",a="bg-success text-danger"),r.a.createElement("div",{className:"seat-selection-page-container"},r.a.createElement("div",{className:"full-bloom seat-selection-page-title-panel"},r.a.createElement("h1",null,"\u667a\u80fd\u62a2\u5ea7\u7cfb\u7edf\u3002"),r.a.createElement("button",{className:"button-item btn btn-danger",onClick:function(){e.props.setValueHandler("userID",null),e.props.setValueHandler("condition",!1)}},"\u9000\u51fa")),r.a.createElement("div",{className:"selection-page-options-panel"},r.a.createElement("div",{className:"full-bloom option-item"},r.a.createElement("strong",null,"\u672c\u9009\u9879\u53ef\u8ba9\u60a8\u8fdb\u5165\u81ea\u4fee\u5ba4\u5ea7\u4f4d\u9605\u89c8\u7f51\u5740\uff0c\u5141\u8bb8\u60a8\u5148\u4eba\u4e00\u6b65\u83b7\u53d6\u60f3\u8981\u7684\u5ea7\u4f4d\u3002"),r.a.createElement("ul",{className:"warning-list"},"\u8bf7\u6ce8\u610f",r.a.createElement("li",null,"\u5c3d\u7ba1\u60a8\u53ef\u4ee5\u63d0\u524d\u8fdb\u5165\u5ea7\u4f4d\u9605\u89c8\u7f51\u5740\uff0c\u7b2c\u4e8c\u65e5\u7684\u5ea7\u4f4d\u9884\u7ea6\u7684\u5f00\u653e\u65f6\u95f4\u5927\u7ea6\u5728\u665a\u4e0a8\u70b930\u520610\u79d2\u523020\u79d2\u5de6\u53f3\u3002"),r.a.createElement("li",null,"\u82e5\u60a8\u957f\u65f6\u95f4\u672a\u5728\u5fae\u4fe1\u4e0a\u767b\u9646\uff08\u4e00\u5468\uff09\uff0c\u60a8\u9700\u5728\u624b\u673a\u4e0a\u5148\u767b\u9646\u65b9\u53ef\u6709\u6548\u3002"),r.a.createElement("li",null,"\u82e5\u60a8\u53ea\u9009\u5230\u4e86\u5f53\u5929\u7684\u5ea7\u4f4d\uff0c10\u79d2\u5de6\u53f3\u5ea7\u4f4d\u4f1a\u88ab\u6e05\u7a7a\u3002"),r.a.createElement("li",null,"\u82e5\u5ea7\u4f4d\u9605\u89c8\u7f51\u5740\u4e0a\u663e\u793a\u201c\u7cfb\u7edf\u6682\u65f6\u65e0\u6cd5\u53d7\u7406\uff0c\u8bf7\u91cd\u65b0\u5c1d\u8bd5\u201d\u7684\u8bdd\uff0c\u8bf7\u5237\u65b0\u7f51\u9875\u76f4\u5230\u51fa\u73b0\u5ea7\u4f4d\uff0c\u4f46\u7ee7\u7eed\u5237\u65b0\u4f1a\u4f7f\u5f53\u524d\u7f51\u5740\u5931\u6548\u3002")),r.a.createElement("div",{className:"self-selection-panel"},r.a.createElement("button",{className:"button-item btn btn-primary",onClick:function(){e.props.getRoomEnterSerial(function(t){if(t){var a=e.props.anatomy.domain+"/"+e.props.anatomy.selectJSPPath+"?"+e.props.anatomy.serialQuery+t+"&"+e.props.anatomy.openIDQuery+e.props.userID+"&"+e.props.anatomy.roomNameQuery+e.props.anatomy.roomNameUnknown+"&"+e.props.anatomy.yuelanshiIDQuery+e.props.anatomy.firstFloorRoomID;window.open(a,"_blank"),e.setState({selfSeatSelectionStatus:!0})}else e.setState({selfSeatSelectionStatus:!1})})}},"\u5f00\u59cb\u81ea\u52a9\u9009\u5ea7"),r.a.createElement("div",{className:a+" seat-self-selection-status"},"\u72b6\u6001\uff1a"+t))),r.a.createElement("div",{className:"full-bloom option-item"},r.a.createElement("div",null,r.a.createElement("strong",null,"\u672c\u9009\u9879\u53ef\u6839\u636e\u60a8\u7684\u5ea7\u4f4d\u503e\u5411\uff0c\u4f7f\u672c\u7cfb\u7edf\u4e3a\u60a8\u9009\u62e9\u5ea7\u4f4d\u3002"),r.a.createElement("ul",{className:"warning-list"},"\u8bf7\u6ce8\u610f",r.a.createElement("li",null,"\u82e5\u60a8\u957f\u65f6\u95f4\u672a\u5728\u5fae\u4fe1\u4e0a\u767b\u9646\uff08\u4e00\u5468\uff09\uff0c\u60a8\u9700\u5728\u624b\u673a\u4e0a\u5148\u767b\u9646\u65b9\u53ef\u6709\u6548\u3002"),r.a.createElement("li",null,"\u62a2\u5ea7\u7cfb\u7edf\u6709\u62a2\u4e0d\u5230\u5ea7\u4f4d\u7684\u98ce\u9669\uff0c\u4f7f\u7528\u65f6\u987b\u8c28\u614e\u3002"))),r.a.createElement("button",{className:"button-item btn btn-primary",onClick:function(){e.setState({redirectToAutoSelection:!0})}},"\u81ea\u52a8\u9009\u5ea7\u7cfb\u7edf"))))}}]),t}(n.Component),k=function(e){function t(e){var a;Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={back:!1,firstPreference:{label:"\u65e0",value:""},secondPreference:{label:"\u65e0",value:""},thirdPreference:{label:"\u505c\u6b62\u62a2\u5ea7",value:""},automationStart:!1,isSuccess:!1,failReason:null},a.seatOptions=[{label:"\u65e0",value:""}];for(var n=1;n<=208;n++){var r=n+" (";a.isSingle(n)?r+="\u5355\u5ea7)":r+="\u53cc\u5ea7)",a.seatOptions.push({label:r,value:n})}a.seatOptionsRange=[{label:"\u65e0",value:""}];for(var i=1;i<=20;i++){var o=10*(i-1)+1,l=10*i;a.seatOptionsRange.push({label:o+" ~ "+l,value:{start:o,end:l}})}return a.monthConverter={Jan:"01",Feb:"02",Mar:"03",Apr:"04",May:"05",Jun:"06",Jul:"07",Aug:"08",Sep:"09",Oct:"10",Nov:"11",Dec:"12"},a.seatPriority=null,a.pause=!1,a.firstPause=!1,a.firstStart=!1,a.seatOptionsRange.push({label:"201 ~ 208",value:{start:201,end:208}}),a.searchSeatAndReserveLoop=a.searchSeatAndReserveLoop.bind(Object(m.a)(a)),a.checkVadility=a.checkVadility.bind(Object(m.a)(a)),a.leaveSeat=a.leaveSeat.bind(Object(m.a)(a)),a.firstLog=null,a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentDidUpdate",value:function(e){if(this.state.automationStart&&this.state.automationStart!==e.automationStart){this.creatLogPiece(this.getCurrntTime()+" --- \u5f00\u59cb\u9884\u7ea6");this.getCurrentHourAndMinute();this.searchSeatAndReserveLoop()}}},{key:"reservePiece",value:function(e,t){var a=this;this.creatLogPiece(this.getCurrntTime()+" --- \u627e\u5230\u76ee\u6807"),this.creatLogPiece(this.getCurrntTime()+" --- \u5f00\u59cb\u9884\u7ea6\u7b2c"+e+"\u53f7\u5ea7\u4f4d \uff08\u7b2c"+t+"\u76ee\u6807\uff09"),this.reserveSeat(e,function(e){a.getReserveResult(e,function(e){var n=a.judgeReserveResult(e);n.isReserveSuccess?(a.creatLogPiece(a.getCurrntTime()+" --- \u6210\u529f\u9884\u7ea6\u7b2c\u4e8c\u5929\u5ea7\u4f4d"),1===t?(a.creatLogPiece(a.getCurrntTime()+" --- \u7b2c1\u76ee\u6807\u5b8c\u6210\uff0c\u4efb\u52a1\u7ed3\u675f"),a.creatLogPiece("\u8bf7\u70b9\u51fb\u7ec8\u6b62\u9884\u7ea6\u6309\u94ae")):(a.creatLogPiece(a.getCurrntTime()+" --- \u7b2c"+t+"\u76ee\u6807\u5b8c\u6210\uff0c\u7ee7\u7eed\u62a2\u5ea7"),a.seatPriority=t,a.searchSeatAndReserveLoop())):(a.creatLogPiece(a.getCurrntTime()+" --- \u56e0\u4e3a"+n.reason+", \u9884\u7ea6\u5931\u8d25"),"\u4ec5\u9884\u7ea6\u5f53\u5929\u5ea7\u4f4d"!==n.reason?a.state.automationStart&&a.searchSeatAndReserveLoop():(a.creatLogPiece(a.getCurrntTime()+" --- \u5f00\u59cb\u79bb\u5f00\u5ea7\u4f4d"),a.leaveSeat(function(){return a.searchSeatAndReserveLoop()})))})})}},{key:"searchSeatAndReserveLoop",value:function(){var e=this;this.pause?(console.log("paused"),setTimeout(function(){e.firstPause&&(e.creatLogPiece(e.getCurrntTime()+" --- \u5f00\u59cb\u505c\u6b62\u81ea\u52a8\u9884\u7ea6\u7cfb\u7edf"),e.creatLogPiece(e.getCurrntTime()+" ---------------------"),e.creatLogPiece(e.getCurrntTime()+" --- \u6682\u505c\u6210\u529f"),e.firstPause=!1,setTimeout(function(){e.searchSeatAndReserveLoop()})),e.firstStart||e.creatLogPiece(e.getCurrntTime()+" --- \u6682\u505c\u4e2d"),e.searchSeatAndReserveLoop()},3e3)):(this.firstStart&&(this.firstStart=!1,this.creatLogPiece(this.getCurrntTime()+" ---------------------"),this.creatLogPiece(this.getCurrntTime()+" --- \u91cd\u65b0\u5f00\u59cb\u81ea\u52a8\u9884\u7ea6\u7cfb\u7edf")),this.creatLogPiece(this.getCurrntTime()+" --- \u5f00\u59cb\u641c\u7d22\u5ea7\u4f4d"),this.props.getRoomEnterSerial(function(t){t?e.findAllPossibleSeats(t,function(t){var a=null,n=null;if(""!==e.state.firstPreference.value&&t.includes(e.state.firstPreference.value)&&(a=e.state.firstPreference.value,n=1),null===a&&""!==e.state.secondPreference.value)for(var r=e.state.secondPreference.value.start;r<=e.state.secondPreference.value.end;r++)t.includes(r)&&(a=r,n=2);null===a&&""!==e.state.thirdPreference.value&&("single"===e.state.thirdPreference.value?t.forEach(function(t){e.isSingle(t)&&(console.log("call"),a=t,n=3)}):"double"===e.state.thirdPreference.value?t.forEach(function(t){e.isSingle(t)||(a=t,n=3)}):t.length>0&&(a=t[0],n=3)),console.log("target : "+a),console.log("priority : "+n),a&&(null===e.seatPriority||n<e.seatPriority)?e.seatPriority&&n<e.seatPriority?(e.seatPriority=null,e.leaveSeat(function(){e.reservePiece(a,n)})):e.reservePiece(a,n):(e.creatLogPiece(e.getCurrntTime()+" --- \u5c1a\u672a\u51fa\u73b0\u76ee\u6807\u5ea7\u4f4d"),""===e.state.thirdPreference.value?(e.creatLogPiece(e.getCurrntTime()+" --- \u56e0\u4e3a\u5931\u53bb\u76ee\u6807\uff0c\u672c\u7cfb\u7edf\u505c\u6b62\u9884\u7ea6\u5ea7\u4f4d"),e.creatLogPiece("\u8bf7\u70b9\u51fb\u7ec8\u6b62\u9884\u7ea6\u6309\u94ae")):e.checkBefore21PM()&&e.state.automationStart&&(e.creatLogPiece(e.getCurrntTime()+" --- \u91cd\u65b0\u5f00\u59cb\u641c\u7d22\u5ea7\u4f4d"),e.searchSeatAndReserveLoop()))}):e.showMachenismError()}))}},{key:"leaveSeat",value:function(e){var t=this,a=this.props.anatomy.domain+"/"+this.props.anatomy.leavePath+"?"+this.props.anatomy.openIDQuery+this.props.userID;fetch(a).then(function(e){return e.text()}).then(function(a){a.includes("\u53d6\u6d88\u9884\u5b9a\uff01")||a.includes("\u9605\u89c8\u5ba4\uff1a\u65e0\u4fe1\u606f\uff01")?(t.creatLogPiece(t.getCurrntTime()+" --- \u79bb\u5f00\u5ea7\u4f4d\u6210\u529f"),t.state.automationStart&&e()):(t.creatLogPiece(t.getCurrntTime()+" --- \u79bb\u5f00\u5ea7\u4f4d\u5931\u8d25"),t.creatLogPiece(t.getCurrntTime()+" --- \u91cd\u65b0\u5c1d\u8bd5\u79bb\u5f00\u5ea7\u4f4d"),t.leaveSeat(e))})}},{key:"findAllPossibleSeats",value:function(e,t){fetch(this.getSeatViewURL(e)).then(function(e){return e.text()}).then(function(e){var a=e.split("\n"),n=[];a.forEach(function(e){if(e.includes('onclick="dianji(')){var t=e.split(">");if(t[1]){var a=t[1].split("<");a[0]&&n.push(parseInt(a[0],10))}}}),console.log(n),t(n)})}},{key:"judgeReserveResult",value:function(e){if(e.includes("\u60a8\u7684\u4f4d\u7f6e\u5728"))return{isReserveSuccess:!1,reason:"\u5f53\u5929\u5ea7\u4f4d\u5c1a\u672a\u89e3\u9664"};if(e.includes("\u7ec8\u7aef\u673a\u5237\u5361")){var t=this.getCurrntTime().split(" ")[0];return console.log(t),e.includes(t)?{isReserveSuccess:!1,reason:"\u4ec5\u9884\u7ea6\u5f53\u5929\u5ea7\u4f4d"}:{isReserveSuccess:!0,reason:"\u6210\u529f\u9884\u7ea6\u7b2c\u4e8c\u5929\u5ea7\u4f4d"}}return e.includes("\u6392\u961f")?{isReserveSuccess:!1,reason:"\u6b63\u5728\u9884\u7ea6\u5176\u4ed6\u5ea7\u4f4d"}:e.includes("\u8be5\u5ea7\u4f4d\u5df2\u7ecf\u88ab\u9884\u7ea6")?{isReserveSuccess:!1,reason:"\u8be5\u5ea7\u4f4d\u5df2\u7ecf\u88ab\u4ed6\u4eba\u9884\u7ea6"}:e.includes("\u5df2\u9884\u7ea6")?{isReserveSuccess:!1,reason:"\u60a8\u5df2\u7ecf\u6210\u529f\u9884\u7ea6\u5ea7\u4f4d"}:(this.showMachenismError(),null)}},{key:"creatLogPiece",value:function(e){var t=document.getElementById("reservation-log");if(t){var a=document.createElement("li"),n=document.createTextNode(e);a.appendChild(n),this.firstLog?t.insertBefore(a,this.firstLog):t.appendChild(a),this.firstLog=a}}},{key:"getReserveSeatURL",value:function(e){return this.props.anatomy.domain+"/"+this.props.anatomy.reservePath+"?"+this.props.anatomy.roomIDQuery+this.props.anatomy.firstFloorRoomID+"&"+this.props.anatomy.openIDQuery+this.props.userID+"&"+this.props.anatomy.seatNumQuery+e}},{key:"getSeatViewURL",value:function(e){return this.props.anatomy.domain+"/"+this.props.anatomy.selectJSPPath+"?"+this.props.anatomy.serialQuery+e+"&"+this.props.anatomy.openIDQuery+this.props.userID+"&"+this.props.anatomy.roomNameQuery+this.props.anatomy.roomNameUnknown+"&"+this.props.anatomy.yuelanshiIDQuery+this.props.anatomy.firstFloorRoomID}},{key:"isSingle",value:function(e){return e>=89&&e<=110||e>=191&&e<=208}},{key:"reserveSeat",value:function(e,t){var a=this.getReserveSeatURL(e);console.log(a),fetch(a).then(function(e){return e.text()}).then(function(e){console.log(e),t(e)})}},{key:"getReserveResult",value:function(e,t){var a=this,n=e.split("serialNo=");n[1]?this.checkVadility(n[1],function(){var e=a.props.anatomy.domain+"/"+a.props.anatomy.selectJSPPath+"?"+a.props.anatomy.serialQuery+n[1];fetch(e).then(function(e){return e.text()}).then(function(e){var n=e.split('<a href="" class="" ');if(n[1]){var r=n[1].split("</a>");if(r[0]){var i=r[0].split(">");if(i[1]){var o=i[1];console.log(o),t(o)}else a.showMachenismError()}else a.showMachenismError()}else a.showMachenismError()})}):this.showMachenismError()}},{key:"showMachenismError",value:function(){this.creatLogPiece("\u56e0\u9884\u7ea6\u5ea7\u4f4d\u673a\u5236\u6539\u53d8\uff0c\u672c\u7cfb\u7edf\u5df2\u7ecf\u5931\u6548"),this.creatLogPiece("\u8bf7\u70b9\u51fb\u7ec8\u6b62\u9884\u7ea6\u6309\u94ae")}},{key:"checkBefore21PM",value:function(){return this.getCurrentHourAndMinute().hour<21||(this.creatLogPiece("\u56e0\u5df2\u7ecf\u8fc721\u70b9\uff0c\u7ee7\u7eed\u9884\u7ea6\u5df2\u65e0\u610f\u4e49\uff0c\u56e0\u6b64\u505c\u6b62\u9884\u7ea6\u3002"),this.creatLogPiece("\u8bf7\u70b9\u51fb\u53d6\u6d88\u6309\u94ae"),!1)}},{key:"getCurrntTime",value:function(){var e=(new Date).toString().split(" ");return e[3]+"-"+this.monthConverter[e[1]]+"-"+e[2]+" "+e[4]}},{key:"getCurrentHourAndMinute",value:function(){var e=(new Date).toString().split(" ")[4].split(":");return{hour:e[0],minute:e[1]}}},{key:"checkVadility",value:function(e,t){var a=this,n=this.props.anatomy.domain+"/"+this.props.anatomy.selectSerialPath+"?"+this.props.anatomy.serialQuery+e;fetch(n).then(function(e){return e.text()}).then(function(n){console.log(n),"no"===n?a.checkVadility(e,t):t()})}},{key:"render",value:function(){var e=this;if(!this.props.userID||!this.props.agree)return r.a.createElement(v.a,{to:"/"});if(this.state.back)return r.a.createElement(v.a,{to:"/seat-selection"});var t="button-item btn btn-primary",a="\u8bf7\u9009\u62e9\u60a8\u60f3\u8981\u7684\u5ea7\u4f4d",n=""===this.state.firstPreference.value&&""===this.state.secondPreference.value&&""===this.state.thirdPreference.value,i="\u8bbe\u5b9a";return this.state.automationStart&&(i=""),n||(t="button-item btn btn-success",a="\u5f00\u59cb\u62a2\u5ea7"),r.a.createElement("div",{className:"auto-selection-page"},r.a.createElement("div",{className:"full-bloom"},r.a.createElement("h1",null,"\u81ea\u52a8\u9009\u5ea7\u8bbe\u5b9a"+i),r.a.createElement("button",{className:"button-item btn btn-danger",onClick:function(){e.setState({back:!0,automationStart:!1}),e.pause=!1,e.firstPause=!1,e.firstStart=!1}},"\u8fd4\u56de")),!this.state.automationStart&&r.a.createElement("div",{className:"full-bloom automation-middle-part"},r.a.createElement("div",{className:"auto-option-item"},r.a.createElement("h2",null,"\u8bf7\u9009\u62e9\u60a8\u6700\u60f3\u8981\u7684\u4e00\u4e2a\u5ea7\u4f4d"),r.a.createElement(S.a,{name:"firstPreference",options:this.seatOptions,value:this.state.firstPreference,onChange:function(t){e.setState({firstPreference:t})}})),r.a.createElement("div",{className:"auto-option-item"},r.a.createElement("h2",null,"\u5176\u6b21\uff0c\u8bf7\u9009\u62e9\u60a8\u53ef\u4ee5\u63a5\u53d7\u7684\u5ea7\u4f4d\u8303\u56f4"),r.a.createElement(S.a,{name:"secondPreference",options:this.seatOptionsRange,value:this.state.secondPreference,onChange:function(t){e.setState({secondPreference:t})}})),r.a.createElement("div",{className:"auto-option-item"},r.a.createElement("h2",null,"\u82e5\u4e0a\u8ff0\u5ea7\u4f4d\u5747\u65e0\u6cd5\u83b7\u5f97\uff0c\u8bf7\u9009\u62e9\u53ef\u63a5\u53d7\u7684\u5ea7\u4f4d\u7684\u7c7b\u578b"),r.a.createElement(S.a,{name:"thirdPreference",options:[{label:"\u505c\u6b62\u62a2\u5ea7",value:""},{label:"\u4efb\u610f\u5ea7\u4f4d",value:"any"},{label:"\u4efb\u610f\u5355\u5ea7",value:"single"},{label:"\u4efb\u610f\u53cc\u5ea7",value:"double"}],value:this.state.thirdPreference,onChange:function(t){e.setState({thirdPreference:t})}}))),this.state.automationStart&&r.a.createElement("div",{className:"full-bloom"},r.a.createElement("ul",null,"\u5f53\u524d\u6307\u793a\uff1a",r.a.createElement("li",null,"\u9996\u8981\u76ee\u6807-"+this.state.firstPreference.label),r.a.createElement("li",null,"\u6b21\u8981\u76ee\u6807-"+this.state.secondPreference.label),r.a.createElement("li",null,"\u5ea7\u4f4d\u7c7b\u578b\u503e\u5411\uff1a"+this.state.thirdPreference.label)),r.a.createElement("h2",null,"\u9884\u7ea6\u72b6\u6001\u76ee\u5f55\uff1a"),r.a.createElement("ul",{id:"reservation-log"})),r.a.createElement("div",null,!this.state.automationStart&&r.a.createElement("button",{className:t+" auto-start-button",disabled:n,onClick:function(){e.setState({automationStart:!0}),e.pause=!1}},a),this.state.automationStart&&r.a.createElement("div",null,r.a.createElement("div",{id:"loop-control-button"},r.a.createElement("div",{id:"loop-control-status"},"\u6682\u505c"),r.a.createElement("button",{id:"loop-button",className:"button-item btn btn-primary",onClick:function(){var t=document.getElementById("loop-control-button"),a=document.getElementById("loop-control-status"),n=document.getElementById("loop-button");if(e.pause){e.firstStart=!0,e.firstPause=!1,e.pause=!1,t.removeChild(a);var r=document.createElement("div");r.id="loop-control-status";var i=document.createTextNode("\u6682\u505c");r.appendChild(i),t.insertBefore(r,n)}else{e.firstPause=!0,e.pause=!0,e.firstStart=!1,t.removeChild(a);var o=document.createElement("div");o.id="loop-control-status";var s=document.createTextNode("\u5f00\u59cb");o.appendChild(s),t.insertBefore(o,n),e.creatLogPiece(e.getCurrntTime()+" --- \u5f00\u59cb\u6682\u505c\u81ea\u52a8\u9884\u7ea6\u7cfb\u7edf")}}},"\u70b9\u6211")),r.a.createElement("button",{className:"button-item btn btn-danger auto-end-button",onClick:function(){e.setState({automationStart:!1}),e.pause=!1,e.firstPause=!1,e.firstStart=!1,e.firstLog=!1}},"\u7ec8\u6b62\u9884\u7ea6"))))}}]),t}(n.Component),N=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={condition:!1,userID:null},a.anatomy={domain:"http://wx.jlcclib.com/wechat",obtainListPath:"obtainYlist",obtainSeatInfoPath:"obtainAllSeatInfo",selectSerialPath:"selectSerialNo",selectJSPPath:"selectSerialNoToJsp",reservePath:"reserve",leavePath:"leave",roomIDQuery:"id=",roomNameQuery:"name=",openIDQuery:"openId=of_",serialQuery:"serialNo=",yuelanshiIDQuery:"yuelanshiId=",showIDQuery:"id=",seatNumQuery:"seatno=",firstFloorRoomID:"402881b14586df4a014586e28aae0000",firstFloorName:"\u4e00\u697c\u8bfb\u8005\u81ea\u4fee\u533a",roomNameUnknown:"???????"},a.setValueHandler=a.setValue.bind(Object(m.a)(a)),a.getRoomEnterSerial=a.getRoomEnterSerial.bind(Object(m.a)(a)),a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"setValue",value:function(e,t){var a=this.state;a[e]=t,this.setState(a)}},{key:"getRoomEnterSerial",value:function(e){var t=this;if(this.state.userID){var a=this.anatomy.domain+"/"+this.anatomy.obtainSeatInfoPath+"?"+this.anatomy.roomIDQuery+this.anatomy.firstFloorRoomID+"&"+this.anatomy.openIDQuery+this.state.userID+"&"+this.anatomy.roomNameQuery+this.anatomy.firstFloorName;fetch(a).then(function(e){return e.text()}).then(function(a){console.log(a);var n=a.split("serialNo=");n[1]?t.checkVadility(n[1],e):e(null)})}else e(null)}},{key:"checkVadility",value:function(e,t){var a=this,n=this.anatomy.domain+"/"+this.anatomy.selectSerialPath+"?"+this.anatomy.serialQuery+e;console.log(n),fetch(n).then(function(e){return e.text()}).then(function(n){console.log(n),"no"===n?a.checkVadility(e,t):t(e)})}},{key:"render",value:function(){var e=this;return r.a.createElement(d.a,null,r.a.createElement(f.a,null,r.a.createElement(p.a,{exact:!0,path:"/",component:g}),r.a.createElement(p.a,{path:"/disclaimer",render:function(t){return r.a.createElement(E,Object.assign({},t,{setValueHandler:e.setValueHandler}))}}),r.a.createElement(p.a,{path:"/id-collecter",render:function(t){return r.a.createElement(y,Object.assign({},t,{setValueHandler:e.setValueHandler,agree:e.state.condition}))}}),r.a.createElement(p.a,{path:"/seat-selection",render:function(t){return r.a.createElement(P,Object.assign({},t,{setValueHandler:e.setValueHandler,userID:e.state.userID,agree:e.state.condition,getRoomEnterSerial:e.getRoomEnterSerial,anatomy:e.anatomy}))}}),r.a.createElement(p.a,{path:"/auto-selection",render:function(t){return r.a.createElement(k,Object.assign({},t,{userID:e.state.userID,setValueHandler:e.setValueHandler,agree:e.state.condition,anatomy:e.anatomy,getRoomEnterSerial:e.getRoomEnterSerial}))}})))}}]),t}(n.Component),C=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function w(e){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}}).catch(function(e){console.error("Error during service worker registration:",e)})}a(59);o.a.render(r.a.createElement(N,null),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("/seat-selection",window.location).origin!==window.location.origin)return;window.addEventListener("load",function(){var e="".concat("/seat-selection","/service-worker.js");C?(function(e){fetch(e).then(function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):w(e)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")})):w(e)})}}()}},[[37,1,2]]]);
//# sourceMappingURL=main.f50a2a0e.chunk.js.map